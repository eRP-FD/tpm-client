/*
 * (C) Copyright IBM Deutschland GmbH 2021, 2023
 * (C) Copyright IBM Corp 2021, 2023
 *
 * non-exclusively licensed to gematik GmbH
 */

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include "ClientUser.h"

#include "Client.h"

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

tpmclient::ClientUser::ClientUser(const Client& client)
: mClient{client}
{
    mClient.attemptToUse();
    mClient.flushKeys();
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

tpmclient::ClientUser::~ClientUser()
{
    mClient.flushKeys();
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

const tpmclient::Client& tpmclient::ClientUser::getClient() const
{
    return mClient;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
